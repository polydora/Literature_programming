---
title: "Плохие и хорошие данные"
author: "Вадим Хайтов"
subtitle: "Литературное программирование"
output:
  ioslides_presentation:
    css: assets/my_styles.css
    logo: assets/LMBE_logo.png    
    widescreen: yes
---

```{r setup, include = FALSE, cache = FALSE, purl = FALSE}
# output options
options(width = 70, scipen = 6, digits = 3)
library(knitr)
# chunk default options
opts_chunk$set(fig.align='center', tidy = FALSE, fig.width = 7, fig.height = 3, warning = FALSE)
```

```{r libs, echo=FALSE}
library(readxl)
library(ggplot2)
```

# Данные 

## Исходные данные часто приходится приводить в порядок

На подготовку данных к анализу уходит до 80% времени.

Существуют определенные правила предоставления данных.

Данные, построенные в соответствии с этими требованиями, называются **tidy data**, или\ **опрятные данные**.

## Проблемы начинаются уже в электронных таблицах
![](images/Excel_sheet.jpg)

## Основные ошибки

- Объединенные ячейки
- Отсутствующие заголовки столбцов, вместо них стоят какие-то числа (или ничего не стоит) или слишком длинные имена заголовков
- В одной ячейке находится сразу несколько значений
- Разнородные данные в пределах одного столбца
- Нет стандартного обозначения пропущенных значений
- Разные группы значений кодируются цветовыми выделениями

## Принятые нормы

- Столбцы - переменные (variables)
- Строки - объекты (observations)
- В каждой переменной только один тип данных 
- На месте пропущенных значений стоит специальный знак (в R принят `NA`)

**При работе в Excel не должно быть никаких объединенных ячеек!** 


## Два формата представления данных 

- Широкий формат: данные максимально структурированы, каждая строка может нести информацию о многих элементарных объектах

- Длинный формат: данные минимально структурированы, каждая строка характеризует уникальный объект


Из длинного формата легко получить широкий. 

Из широкого формата получить длинный заметно сложнее.

Широкий формат хорош для отчетов, представления обобщенных результатов

Длинный формат хорош для анализа



```{r echo=FALSE}
titanic <- read.table('data/Titanic.csv', 
                      sep = ';', 
                      header = TRUE)
```

## В каком формате представлены данные?

```{r echo=FALSE}
head(titanic, 20)

```

## Длинный формат данных


```{r echo= FALSE}
library(tidyr)
long_titanic <- uncount(titanic, 
                        weights = Freq)
head(long_titanic, 20)
```



